{"version":3,"sources":["../../../../assets/scripts/assets/scripts/gameLogic.js"],"names":["cc","Class","extends","Component","properties","spawnFishDt","fishPrefab","default","type","Prefab","fishMoveDuration","dollorLabelPrefab","catchedFishAnimTime","getFishNodeOriginPosition","visible","fishesNode","Node","getFishNode","dollorLabelesNode","catchedFishesNode","onLoad","node","on","touchBegan","touchMoved","touchEnd","touchCancel","schedule","spwanOneFish","getPosition","start","event","x","getLocationX","y","getLocationY","location","convertToNodeSpaceAR","v2","setPosition","motionComponent","getComponent","MotionStreak","enabled","motion","onDestroy","off","newFish","instantiate","spawnAreaNum","Math","random","floor","targetSpawnAreaNum","spawnPosition","getOneRandomPositionBySpawnArea","addChild","targetPositon","helper","require","turnOneNodeToOnePosition","swimLeft","rotateBy","leftBack","swimRight","rightBack","swimAction","sequence","swimAnimation","repeatForever","runAction","moveAction","moveTo","fishAction","removeSelf","spawnX","spawnY","width","height","update","dt","fishes","children","length","isOneNodeInAnotherNode","position","removeFromParent","catchedFish","catchedFishTargetPosition","jumpAction","jumpTo","scaleUpAction","scaleTo","scaleDownAction","scalAction","action","spawn","newLabel","fadeOut"],"mappings":"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","file":"gameLogic.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // foo: {\n        //     // ATTRIBUTES:\n        //     default: null,        // The default value will be used only when the component attaching\n        //                           // to a node for the first time\n        //     type: cc.SpriteFrame, // optional, default is typeof default\n        //     serializable: true,   // optional, default is true\n        // },\n        // bar: {\n        //     get () {\n        //         return this._bar;\n        //     },\n        //     set (value) {\n        //         this._bar = value;\n        //     }\n        // },\n        spawnFishDt: 5,\n        fishPrefab: {\n            default:null,\n            type: cc.Prefab,\n        },\n        fishMoveDuration: 5,\n        dollorLabelPrefab: {\n            default:null,\n            type: cc.Prefab,\n        },\n        catchedFishAnimTime: 0.5,\n        getFishNodeOriginPosition: {\n            default: null,\n            visible: false,\n        },\n        \n        fishesNode: {\n            default: null,\n            type: cc.Node,\n        },\n        getFishNode: {\n            default: null,\n            type: cc.Node,\n        },\n        dollorLabelesNode: {\n            default: null,\n            type: cc.Node,\n        },\n        catchedFishesNode: {\n            default: null,\n            type: cc.Node,\n        },\n\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n     onLoad () {\n        this.node.on(\"touchstart\",this.touchBegan,this);\n        this.node.on(\"touchmove\",this.touchMoved,this);\n        this.node.on(\"touchend\",this.touchEnd,this);\n        this.node.on(\"touchcancel\",this.touchCancel,this);\n\n        this.schedule(function(){\n            this.spwanOneFish();\n        },this.spawnFishDt);\n\n        this.getFishNodeOriginPosition = this.getFishNode.getPosition();\n     },\n\n    start () {\n    },\n    touchBegan(event){\n        var x = event.getLocationX();\n        var y = event.getLocationY();\n        var location = this.node.convertToNodeSpaceAR(cc.v2(x,y));\n\n        this.getFishNode.setPosition(location.x,location.y);\n        var motionComponent = this.getFishNode.getComponent(cc.MotionStreak);\n        motionComponent.enabled = true;\n\n    },\n    touchMoved(event){\n        var x = event.getLocationX();\n        var y = event.getLocationY();\n        var location = this.node.convertToNodeSpaceAR(cc.v2(x,y));\n        this.getFishNode.setPosition(location.x,location.y);\n    },\n    touchEnd(event){\n        var motion = this.getFishNode.getComponent(cc.MotionStreak);\n        motion.enabled = false;\n        this.getFishNode.setPosition(this.getFishNodeOriginPosition);\n\n    },\n    touchCancel(event){\n\n    },\n\n    onDestroy(){\n        this.node.off(\"touchstart\",this.touchBegan,this);\n        this.node.off(\"touchmove\",this.touchMoved,this);\n        this.node.off(\"touchend\",this.touchEnd,this);\n        this.node.off(\"touchcancel\",this.touchCancel,this); \n    },\n    spwanOneFish(){\n        var newFish = cc.instantiate(this.fishPrefab);\n        //select one spwan area. There are 4 areas for spwan , which are distributed of the screen's left,right,top and bottom\n        //0 -> left\n        //1 -> right\n        //2 -> top\n        //3 -> bottom\n        var spawnAreaNum = Math.random() * 4;\n        spawnAreaNum = Math.floor(spawnAreaNum);\n        var targetSpawnAreaNum = null;\n        switch(spawnAreaNum) {\n            case 0:\n                targetSpawnAreaNum = 1;\n                break;\n            case 1:\n                targetSpawnAreaNum = 0;\n                break;\n            case 2:\n                targetSpawnAreaNum = 3;\n                break;\n            case 3:\n                targetSpawnAreaNum = 2;\n                break;\n        }\n\n        //fish spwan position\n        var spawnPosition = this.getOneRandomPositionBySpawnArea(spawnAreaNum);\n        newFish.setPosition(spawnPosition);\n        this.fishesNode.addChild(newFish);\n\n        //let fish to face to it's target\n        var targetPositon = this.getOneRandomPositionBySpawnArea(targetSpawnAreaNum);\n        var helper = require(\"helper\");\n        helper.turnOneNodeToOnePosition(newFish,targetPositon);\n\n        //add animation of fish\n        var swimLeft = cc.rotateBy(0.5,30);\n        var leftBack = cc.rotateBy(0.5,-30);\n        var swimRight = cc.rotateBy(0.5,-30);\n        var rightBack = cc.rotateBy(0.5,30);\n        var swimAction = cc.sequence(swimLeft,leftBack,swimRight,rightBack);\n        var swimAnimation = cc.repeatForever(swimAction);\n        newFish.runAction(swimAnimation);\n\n        //let fish to move to it's target\n        var moveAction = cc.moveTo(this.fishMoveDuration,targetPositon);\n        var fishAction = cc.sequence(moveAction,cc.removeSelf());\n\n        newFish.runAction(fishAction);\n\n    },\n    getOneRandomPositionBySpawnArea(spawnAreaNum){\n        var spawnX = null;\n        var spawnY = null;\n        var newFish = cc.instantiate(this.fishPrefab);\n        if(spawnAreaNum == 0) {\n             spawnX = -1 * this.node.width/2 - newFish.width/2;\n             spawnY = Math.random() * this.node.height - this.node.height/2;\n        }\n        else if(spawnAreaNum == 1){\n            spawnX = this.node.width/2 + newFish.width/2;\n            spawnY = Math.random() * this.node.height - this.node.height/2;\n        }\n        else if(spawnAreaNum == 2) {\n            spawnY = this.node.height/2 + newFish.height/2;\n            spawnX = Math.random() * this.node.width - this.node.width/2;\n        }\n        else if(spawnAreaNum == 3) {\n            spawnY = -this.node.height/2 - newFish.height/2;\n            spawnX = Math.random() * this.node.width - this.node.width/2;\n        }\n        return cc.v2(spawnX,spawnY);\n    },\n    update (dt) {\n        var fishes = this.fishesNode.children;\n        var helper = require(\"helper\");\n        if (fishes.length > 0){\n            for(var x in fishes){\n                if (helper.isOneNodeInAnotherNode(this.getFishNode,fishes[x]) == true){\n                    //do something\n                    var position = fishes[x].getPosition();\n                    fishes[x].removeFromParent();\n\n                    //setup catchedFish\n                    var catchedFish = cc.instantiate(this.fishPrefab);\n                    var catchedFishTargetPosition = cc.v2(0,-151);\n                    var jumpAction = cc.jumpTo(this.catchedFishAnimTime,catchedFishTargetPosition,50,1);\n                    var scaleUpAction = cc.scaleTo(0.3 * this.catchedFishAnimTime,1.5,1.5);\n                    var scaleDownAction = cc.scaleTo(0.7 * this.catchedFishAnimTime,0.5,0.5);\n                    var scalAction = cc.sequence(scaleUpAction,scaleDownAction,cc.removeSelf());\n                    var action = cc.spawn(jumpAction,scalAction);\n\n                    catchedFish.position = position;\n                    helper.turnOneNodeToOnePosition(catchedFish,catchedFishTargetPosition);\n                    this.catchedFishesNode.addChild(catchedFish);\n                    catchedFish.runAction(action);\n                    \n                    //setup dollorLabel\n                    var newLabel = cc.instantiate(this.dollorLabelPrefab);\n                    newLabel.setPosition(position);\n                    this.dollorLabelesNode.addChild(newLabel);\n                    var fadeOut = cc.fadeOut(1.0);\n                    var action = cc.sequence(fadeOut,cc.removeSelf());\n                    newLabel.runAction(action);\n                    break;\n                }\n            }\n        } \n    },\n});\n"]}