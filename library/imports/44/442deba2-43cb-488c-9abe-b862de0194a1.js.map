{"version":3,"sources":["../../../../assets/scripts/assets/scripts/gameLogic.js"],"names":["cc","Class","extends","Component","properties","spawnFishDt","fishPrefab","default","type","Prefab","fishMoveDuration","dollorLabelPrefab","onLoad","node","on","touchBegan","touchMoved","touchEnd","touchCancel","schedule","spwanOneFish","start","event","x","getLocationX","y","getLocationY","location","convertToNodeSpaceAR","v2","getFishNode","find","setPosition","onDestroy","off","newFish","instantiate","spawnAreaNum","Math","random","floor","targetSpawnAreaNum","spawnPosition","getOneRandomPositionBySpawnArea","fishesNode","addChild","targetPositon","moveAction","moveTo","fishAction","sequence","removeSelf","runAction","spawnX","spawnY","width","height","update","dt","fishes","children","helper","require","dollorLabelesNode","length","isOneNodeInAnotherNode","position","getPosition","removeFromParent","newLabel","fadeOut","action"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAC,qBAAa,CAhBL;AAiBRC,oBAAY;AACRC,qBAAQ,IADA;AAERC,kBAAMR,GAAGS;AAFD,SAjBJ;AAqBRC,0BAAkB,CArBV;AAsBRC,2BAAmB;AACfJ,qBAAQ,IADO;AAEfC,kBAAMR,GAAGS;AAFM;;AAtBX,KAHP;;AAgCL;;AAECG,UAlCI,oBAkCM;AACP,aAAKC,IAAL,CAAUC,EAAV,CAAa,YAAb,EAA0B,KAAKC,UAA/B,EAA0C,IAA1C;AACA,aAAKF,IAAL,CAAUC,EAAV,CAAa,WAAb,EAAyB,KAAKE,UAA9B,EAAyC,IAAzC;AACA,aAAKH,IAAL,CAAUC,EAAV,CAAa,UAAb,EAAwB,KAAKG,QAA7B,EAAsC,IAAtC;AACA,aAAKJ,IAAL,CAAUC,EAAV,CAAa,aAAb,EAA2B,KAAKI,WAAhC,EAA4C,IAA5C;;AAEA,aAAKC,QAAL,CAAc,YAAU;AACpB,iBAAKC,YAAL;AACH,SAFD,EAEE,KAAKf,WAFP;AAGF,KA3CG;AA6CLgB,SA7CK,mBA6CI,CACR,CA9CI;AA+CLN,cA/CK,sBA+CMO,KA/CN,EA+CY;AACb,YAAIC,IAAID,MAAME,YAAN,EAAR;AACA,YAAIC,IAAIH,MAAMI,YAAN,EAAR;AACA,YAAIC,WAAW,KAAKd,IAAL,CAAUe,oBAAV,CAA+B5B,GAAG6B,EAAH,CAAMN,CAAN,EAAQE,CAAR,CAA/B,CAAf;;AAEA,YAAIK,cAAc9B,GAAG+B,IAAH,CAAQ,oBAAR,CAAlB;AACAD,oBAAYE,WAAZ,CAAwBL,SAASJ,CAAjC,EAAmCI,SAASF,CAA5C;AAEH,KAvDI;AAwDLT,cAxDK,sBAwDMM,KAxDN,EAwDY;AACb,YAAIC,IAAID,MAAME,YAAN,EAAR;AACA,YAAIC,IAAIH,MAAMI,YAAN,EAAR;AACA,YAAIC,WAAW,KAAKd,IAAL,CAAUe,oBAAV,CAA+B5B,GAAG6B,EAAH,CAAMN,CAAN,EAAQE,CAAR,CAA/B,CAAf;;AAEA,YAAIK,cAAc9B,GAAG+B,IAAH,CAAQ,oBAAR,CAAlB;AACAD,oBAAYE,WAAZ,CAAwBL,SAASJ,CAAjC,EAAmCI,SAASF,CAA5C;AACH,KA/DI;AAgELR,YAhEK,oBAgEIK,KAhEJ,EAgEU,CAEd,CAlEI;AAmELJ,eAnEK,uBAmEOI,KAnEP,EAmEa,CAEjB,CArEI;AAuELW,aAvEK,uBAuEM;AACP,aAAKpB,IAAL,CAAUqB,GAAV,CAAc,YAAd,EAA2B,KAAKnB,UAAhC,EAA2C,IAA3C;AACA,aAAKF,IAAL,CAAUqB,GAAV,CAAc,WAAd,EAA0B,KAAKlB,UAA/B,EAA0C,IAA1C;AACA,aAAKH,IAAL,CAAUqB,GAAV,CAAc,UAAd,EAAyB,KAAKjB,QAA9B,EAAuC,IAAvC;AACA,aAAKJ,IAAL,CAAUqB,GAAV,CAAc,aAAd,EAA4B,KAAKhB,WAAjC,EAA6C,IAA7C;AACH,KA5EI;AA6ELE,gBA7EK,0BA6ES;AACV,YAAIe,UAAUnC,GAAGoC,WAAH,CAAe,KAAK9B,UAApB,CAAd;AACA;AACA;AACA;AACA;AACA;AACA,YAAI+B,eAAeC,KAAKC,MAAL,KAAgB,CAAnC;AACAF,uBAAeC,KAAKE,KAAL,CAAWH,YAAX,CAAf;AACA,YAAII,qBAAqB,IAAzB;AACA,gBAAOJ,YAAP;AACI,iBAAK,CAAL;AACII,qCAAqB,CAArB;AACA;AACJ,iBAAK,CAAL;AACIA,qCAAqB,CAArB;AACA;AACJ,iBAAK,CAAL;AACIA,qCAAqB,CAArB;AACA;AACJ,iBAAK,CAAL;AACIA,qCAAqB,CAArB;AACA;AAZR;;AAeA;AACA,YAAIC,gBAAgB,KAAKC,+BAAL,CAAqCN,YAArC,CAApB;AACAF,gBAAQH,WAAR,CAAoBU,aAApB;AACA,YAAIE,aAAa5C,GAAG+B,IAAH,CAAQ,mBAAR,CAAjB;AACAa,mBAAWC,QAAX,CAAoBV,OAApB;;AAEA;AACA,YAAIW,gBAAgB,KAAKH,+BAAL,CAAqCF,kBAArC,CAApB;AACA,YAAIM,aAAa/C,GAAGgD,MAAH,CAAU,KAAKtC,gBAAf,EAAgCoC,aAAhC,CAAjB;AACA,YAAIG,aAAajD,GAAGkD,QAAH,CAAYH,UAAZ,EAAuB/C,GAAGmD,UAAH,EAAvB,CAAjB;;AAEAhB,gBAAQiB,SAAR,CAAkBH,UAAlB;AAEH,KAnHI;AAoHLN,mCApHK,2CAoH2BN,YApH3B,EAoHwC;AACzC,YAAIgB,SAAS,IAAb;AACA,YAAIC,SAAS,IAAb;AACA,YAAInB,UAAUnC,GAAGoC,WAAH,CAAe,KAAK9B,UAApB,CAAd;AACA,YAAG+B,gBAAgB,CAAnB,EAAsB;AACjBgB,qBAAS,CAAC,CAAD,GAAK,KAAKxC,IAAL,CAAU0C,KAAf,GAAqB,CAArB,GAAyBpB,QAAQoB,KAAR,GAAc,CAAhD;AACAD,qBAAShB,KAAKC,MAAL,KAAgB,KAAK1B,IAAL,CAAU2C,MAA1B,GAAmC,KAAK3C,IAAL,CAAU2C,MAAV,GAAiB,CAA7D;AACJ,SAHD,MAIK,IAAGnB,gBAAgB,CAAnB,EAAqB;AACtBgB,qBAAS,KAAKxC,IAAL,CAAU0C,KAAV,GAAgB,CAAhB,GAAoBpB,QAAQoB,KAAR,GAAc,CAA3C;AACAD,qBAAShB,KAAKC,MAAL,KAAgB,KAAK1B,IAAL,CAAU2C,MAA1B,GAAmC,KAAK3C,IAAL,CAAU2C,MAAV,GAAiB,CAA7D;AACH,SAHI,MAIA,IAAGnB,gBAAgB,CAAnB,EAAsB;AACvBiB,qBAAS,KAAKzC,IAAL,CAAU2C,MAAV,GAAiB,CAAjB,GAAqBrB,QAAQqB,MAAR,GAAe,CAA7C;AACAH,qBAASf,KAAKC,MAAL,KAAgB,KAAK1B,IAAL,CAAU0C,KAA1B,GAAkC,KAAK1C,IAAL,CAAU0C,KAAV,GAAgB,CAA3D;AACH,SAHI,MAIA,IAAGlB,gBAAgB,CAAnB,EAAsB;AACvBiB,qBAAS,CAAC,KAAKzC,IAAL,CAAU2C,MAAX,GAAkB,CAAlB,GAAsBrB,QAAQqB,MAAR,GAAe,CAA9C;AACAH,qBAASf,KAAKC,MAAL,KAAgB,KAAK1B,IAAL,CAAU0C,KAA1B,GAAkC,KAAK1C,IAAL,CAAU0C,KAAV,GAAgB,CAA3D;AACH;AACD,eAAOvD,GAAG6B,EAAH,CAAMwB,MAAN,EAAaC,MAAb,CAAP;AACH,KAzII;AA0ILG,UA1IK,kBA0IGC,EA1IH,EA0IO;AACR,YAAId,aAAa5C,GAAG+B,IAAH,CAAQ,mBAAR,CAAjB;AACA,YAAID,cAAc9B,GAAG+B,IAAH,CAAQ,oBAAR,CAAlB;AACA,YAAI4B,SAASf,WAAWgB,QAAxB;AACA,YAAIC,SAASC,QAAQ,QAAR,CAAb;AACA,YAAIC,oBAAoB/D,GAAG+B,IAAH,CAAQ,0BAAR,CAAxB;AACA,YAAI4B,OAAOK,MAAP,GAAgB,CAApB,EAAsB;AAClB,iBAAI,IAAIzC,CAAR,IAAaoC,MAAb,EAAoB;AAChB,oBAAIE,OAAOI,sBAAP,CAA8BnC,WAA9B,EAA0C6B,OAAOpC,CAAP,CAA1C,KAAwD,IAA5D,EAAiE;AAC7D;AACA,wBAAI2C,WAAWP,OAAOpC,CAAP,EAAU4C,WAAV,EAAf;AACAR,2BAAOpC,CAAP,EAAU6C,gBAAV;AACA,wBAAIC,WAAWrE,GAAGoC,WAAH,CAAe,KAAKzB,iBAApB,CAAf;AACA0D,6BAASrC,WAAT,CAAqBkC,QAArB;AACAH,sCAAkBlB,QAAlB,CAA2BwB,QAA3B;AACA,wBAAIC,UAAUtE,GAAGsE,OAAH,CAAW,GAAX,CAAd;AACA,wBAAIC,SAASvE,GAAGkD,QAAH,CAAYoB,OAAZ,EAAoBtE,GAAGmD,UAAH,EAApB,CAAb;AACAkB,6BAASjB,SAAT,CAAmBmB,MAAnB;AACA;AACH;AACJ;AACJ;AACJ;AAhKI,CAAT","file":"gameLogic.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // foo: {\n        //     // ATTRIBUTES:\n        //     default: null,        // The default value will be used only when the component attaching\n        //                           // to a node for the first time\n        //     type: cc.SpriteFrame, // optional, default is typeof default\n        //     serializable: true,   // optional, default is true\n        // },\n        // bar: {\n        //     get () {\n        //         return this._bar;\n        //     },\n        //     set (value) {\n        //         this._bar = value;\n        //     }\n        // },\n        spawnFishDt: 5,\n        fishPrefab: {\n            default:null,\n            type: cc.Prefab,\n        },\n        fishMoveDuration: 5,\n        dollorLabelPrefab: {\n            default:null,\n            type: cc.Prefab,\n        },\n\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n     onLoad () {\n        this.node.on(\"touchstart\",this.touchBegan,this);\n        this.node.on(\"touchmove\",this.touchMoved,this);\n        this.node.on(\"touchend\",this.touchEnd,this);\n        this.node.on(\"touchcancel\",this.touchCancel,this);\n\n        this.schedule(function(){\n            this.spwanOneFish();\n        },this.spawnFishDt);\n     },\n\n    start () {\n    },\n    touchBegan(event){\n        var x = event.getLocationX();\n        var y = event.getLocationY();\n        var location = this.node.convertToNodeSpaceAR(cc.v2(x,y));\n\n        var getFishNode = cc.find(\"Canvas/getFishNode\");\n        getFishNode.setPosition(location.x,location.y);\n\n    },\n    touchMoved(event){\n        var x = event.getLocationX();\n        var y = event.getLocationY();\n        var location = this.node.convertToNodeSpaceAR(cc.v2(x,y));\n\n        var getFishNode = cc.find(\"Canvas/getFishNode\");\n        getFishNode.setPosition(location.x,location.y);\n    },\n    touchEnd(event){\n        \n    },\n    touchCancel(event){\n\n    },\n\n    onDestroy(){\n        this.node.off(\"touchstart\",this.touchBegan,this);\n        this.node.off(\"touchmove\",this.touchMoved,this);\n        this.node.off(\"touchend\",this.touchEnd,this);\n        this.node.off(\"touchcancel\",this.touchCancel,this); \n    },\n    spwanOneFish(){\n        var newFish = cc.instantiate(this.fishPrefab);\n        //select one spwan area. There are 4 areas for spwan , which are distributed of the screen's left,right,top and bottom\n        //0 -> left\n        //1 -> right\n        //2 -> top\n        //3 -> bottom\n        var spawnAreaNum = Math.random() * 4;\n        spawnAreaNum = Math.floor(spawnAreaNum);\n        var targetSpawnAreaNum = null;\n        switch(spawnAreaNum) {\n            case 0:\n                targetSpawnAreaNum = 1;\n                break;\n            case 1:\n                targetSpawnAreaNum = 0;\n                break;\n            case 2:\n                targetSpawnAreaNum = 3;\n                break;\n            case 3:\n                targetSpawnAreaNum = 2;\n                break;\n        }\n\n        //fish spwan position\n        var spawnPosition = this.getOneRandomPositionBySpawnArea(spawnAreaNum);\n        newFish.setPosition(spawnPosition);\n        var fishesNode = cc.find(\"Canvas/fishesNode\");\n        fishesNode.addChild(newFish);\n\n        //let fish to move to it's target\n        var targetPositon = this.getOneRandomPositionBySpawnArea(targetSpawnAreaNum);\n        var moveAction = cc.moveTo(this.fishMoveDuration,targetPositon);\n        var fishAction = cc.sequence(moveAction,cc.removeSelf());\n\n        newFish.runAction(fishAction);\n\n    },\n    getOneRandomPositionBySpawnArea(spawnAreaNum){\n        var spawnX = null;\n        var spawnY = null;\n        var newFish = cc.instantiate(this.fishPrefab);\n        if(spawnAreaNum == 0) {\n             spawnX = -1 * this.node.width/2 - newFish.width/2;\n             spawnY = Math.random() * this.node.height - this.node.height/2;\n        }\n        else if(spawnAreaNum == 1){\n            spawnX = this.node.width/2 + newFish.width/2;\n            spawnY = Math.random() * this.node.height - this.node.height/2;\n        }\n        else if(spawnAreaNum == 2) {\n            spawnY = this.node.height/2 + newFish.height/2;\n            spawnX = Math.random() * this.node.width - this.node.width/2;\n        }\n        else if(spawnAreaNum == 3) {\n            spawnY = -this.node.height/2 - newFish.height/2;\n            spawnX = Math.random() * this.node.width - this.node.width/2;\n        }\n        return cc.v2(spawnX,spawnY);\n    },\n    update (dt) {\n        var fishesNode = cc.find(\"Canvas/fishesNode\");\n        var getFishNode = cc.find(\"Canvas/getFishNode\");\n        var fishes = fishesNode.children;\n        var helper = require(\"helper\");\n        var dollorLabelesNode = cc.find(\"Canvas/dollorLabelesNode\");\n        if (fishes.length > 0){\n            for(var x in fishes){\n                if (helper.isOneNodeInAnotherNode(getFishNode,fishes[x]) == true){\n                    //do something\n                    var position = fishes[x].getPosition();\n                    fishes[x].removeFromParent();\n                    var newLabel = cc.instantiate(this.dollorLabelPrefab);\n                    newLabel.setPosition(position);\n                    dollorLabelesNode.addChild(newLabel);\n                    var fadeOut = cc.fadeOut(1.0);\n                    var action = cc.sequence(fadeOut,cc.removeSelf());\n                    newLabel.runAction(action);\n                    break;\n                }\n            }\n        } \n    },\n});\n"]}