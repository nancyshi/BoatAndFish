{"version":3,"sources":["../../../../assets/scripts/assets/scripts/gameLogic.js"],"names":["cc","Class","extends","Component","properties","spawnFishDt","fishPrefab","default","type","Prefab","fishMoveDuration","dollorLabelPrefab","catchedFishAnimTime","getFishNodeOriginPosition","onLoad","node","on","touchBegan","touchMoved","touchEnd","touchCancel","schedule","spwanOneFish","find","getPosition","start","event","x","getLocationX","y","getLocationY","location","convertToNodeSpaceAR","v2","getFishNode","setPosition","motionComponent","getComponent","MotionStreak","enabled","motion","onDestroy","off","newFish","instantiate","spawnAreaNum","Math","random","floor","targetSpawnAreaNum","spawnPosition","getOneRandomPositionBySpawnArea","fishesNode","addChild","targetPositon","helper","require","turnOneNodeToOnePosition","swimLeft","rotateBy","leftBack","swimRight","rightBack","swimAction","sequence","swimAnimation","repeatForever","runAction","moveAction","moveTo","fishAction","removeSelf","spawnX","spawnY","width","height","update","dt","fishes","children","dollorLabelesNode","length","isOneNodeInAnotherNode","position","removeFromParent","catchedFish","catchedFishTargetPosition","jumpAction","jumpTo","scaleUpAction","scaleTo","scaleDownAction","scalAction","action","spawn","catchedFishesNode","newLabel","fadeOut"],"mappings":"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","file":"gameLogic.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // foo: {\n        //     // ATTRIBUTES:\n        //     default: null,        // The default value will be used only when the component attaching\n        //                           // to a node for the first time\n        //     type: cc.SpriteFrame, // optional, default is typeof default\n        //     serializable: true,   // optional, default is true\n        // },\n        // bar: {\n        //     get () {\n        //         return this._bar;\n        //     },\n        //     set (value) {\n        //         this._bar = value;\n        //     }\n        // },\n        spawnFishDt: 5,\n        fishPrefab: {\n            default:null,\n            type: cc.Prefab,\n        },\n        fishMoveDuration: 5,\n        dollorLabelPrefab: {\n            default:null,\n            type: cc.Prefab,\n        },\n        catchedFishAnimTime: 0.5,\n        getFishNodeOriginPosition: {\n            default: null,\n            \n        },\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n     onLoad () {\n        this.node.on(\"touchstart\",this.touchBegan,this);\n        this.node.on(\"touchmove\",this.touchMoved,this);\n        this.node.on(\"touchend\",this.touchEnd,this);\n        this.node.on(\"touchcancel\",this.touchCancel,this);\n\n        this.schedule(function(){\n            this.spwanOneFish();\n        },this.spawnFishDt);\n\n        this.getFishNodeOriginPosition = cc.find(\"Canvas/getFishNode\").getPosition();\n     },\n\n    start () {\n    },\n    touchBegan(event){\n        var x = event.getLocationX();\n        var y = event.getLocationY();\n        var location = this.node.convertToNodeSpaceAR(cc.v2(x,y));\n\n        var getFishNode = cc.find(\"Canvas/getFishNode\");\n        getFishNode.setPosition(location.x,location.y);\n        var motionComponent = getFishNode.getComponent(cc.MotionStreak);\n        motionComponent.enabled = true;\n\n    },\n    touchMoved(event){\n        var x = event.getLocationX();\n        var y = event.getLocationY();\n        var location = this.node.convertToNodeSpaceAR(cc.v2(x,y));\n\n        var getFishNode = cc.find(\"Canvas/getFishNode\");\n        getFishNode.setPosition(location.x,location.y);\n    },\n    touchEnd(event){\n        var getFishNode = cc.find(\"Canvas/getFishNode\");\n        var motion = getFishNode.getComponent(cc.MotionStreak);\n        motion.enabled = false;\n        getFishNode.setPosition(this.getFishNodeOriginPosition);\n\n    },\n    touchCancel(event){\n\n    },\n\n    onDestroy(){\n        this.node.off(\"touchstart\",this.touchBegan,this);\n        this.node.off(\"touchmove\",this.touchMoved,this);\n        this.node.off(\"touchend\",this.touchEnd,this);\n        this.node.off(\"touchcancel\",this.touchCancel,this); \n    },\n    spwanOneFish(){\n        var newFish = cc.instantiate(this.fishPrefab);\n        //select one spwan area. There are 4 areas for spwan , which are distributed of the screen's left,right,top and bottom\n        //0 -> left\n        //1 -> right\n        //2 -> top\n        //3 -> bottom\n        var spawnAreaNum = Math.random() * 4;\n        spawnAreaNum = Math.floor(spawnAreaNum);\n        var targetSpawnAreaNum = null;\n        switch(spawnAreaNum) {\n            case 0:\n                targetSpawnAreaNum = 1;\n                break;\n            case 1:\n                targetSpawnAreaNum = 0;\n                break;\n            case 2:\n                targetSpawnAreaNum = 3;\n                break;\n            case 3:\n                targetSpawnAreaNum = 2;\n                break;\n        }\n\n        //fish spwan position\n        var spawnPosition = this.getOneRandomPositionBySpawnArea(spawnAreaNum);\n        newFish.setPosition(spawnPosition);\n        var fishesNode = cc.find(\"Canvas/fishesNode\");\n        fishesNode.addChild(newFish);\n\n        //let fish to face to it's target\n        var targetPositon = this.getOneRandomPositionBySpawnArea(targetSpawnAreaNum);\n        var helper = require(\"helper\");\n        helper.turnOneNodeToOnePosition(newFish,targetPositon);\n\n        //add animation of fish\n        var swimLeft = cc.rotateBy(0.5,30);\n        var leftBack = cc.rotateBy(0.5,-30);\n        var swimRight = cc.rotateBy(0.5,-30);\n        var rightBack = cc.rotateBy(0.5,30);\n        var swimAction = cc.sequence(swimLeft,leftBack,swimRight,rightBack);\n        var swimAnimation = cc.repeatForever(swimAction);\n        newFish.runAction(swimAnimation);\n\n        //let fish to move to it's target\n        var moveAction = cc.moveTo(this.fishMoveDuration,targetPositon);\n        var fishAction = cc.sequence(moveAction,cc.removeSelf());\n\n        newFish.runAction(fishAction);\n\n    },\n    getOneRandomPositionBySpawnArea(spawnAreaNum){\n        var spawnX = null;\n        var spawnY = null;\n        var newFish = cc.instantiate(this.fishPrefab);\n        if(spawnAreaNum == 0) {\n             spawnX = -1 * this.node.width/2 - newFish.width/2;\n             spawnY = Math.random() * this.node.height - this.node.height/2;\n        }\n        else if(spawnAreaNum == 1){\n            spawnX = this.node.width/2 + newFish.width/2;\n            spawnY = Math.random() * this.node.height - this.node.height/2;\n        }\n        else if(spawnAreaNum == 2) {\n            spawnY = this.node.height/2 + newFish.height/2;\n            spawnX = Math.random() * this.node.width - this.node.width/2;\n        }\n        else if(spawnAreaNum == 3) {\n            spawnY = -this.node.height/2 - newFish.height/2;\n            spawnX = Math.random() * this.node.width - this.node.width/2;\n        }\n        return cc.v2(spawnX,spawnY);\n    },\n    update (dt) {\n        var fishesNode = cc.find(\"Canvas/fishesNode\");\n        var getFishNode = cc.find(\"Canvas/getFishNode\");\n        var fishes = fishesNode.children;\n        var helper = require(\"helper\");\n        var dollorLabelesNode = cc.find(\"Canvas/dollorLabelesNode\");\n        if (fishes.length > 0){\n            for(var x in fishes){\n                if (helper.isOneNodeInAnotherNode(getFishNode,fishes[x]) == true){\n                    //do something\n                    var position = fishes[x].getPosition();\n                    fishes[x].removeFromParent();\n\n                    //setup catchedFish\n                    var catchedFish = cc.instantiate(this.fishPrefab);\n                    var catchedFishTargetPosition = cc.v2(0,-151);\n                    var jumpAction = cc.jumpTo(this.catchedFishAnimTime,catchedFishTargetPosition,50,1);\n                    var scaleUpAction = cc.scaleTo(0.3 * this.catchedFishAnimTime,1.5,1.5);\n                    var scaleDownAction = cc.scaleTo(0.7 * this.catchedFishAnimTime,0.5,0.5);\n                    var scalAction = cc.sequence(scaleUpAction,scaleDownAction,cc.removeSelf());\n                    var action = cc.spawn(jumpAction,scalAction);\n\n                    catchedFish.position = position;\n                    var helper = require(\"helper\");\n                    helper.turnOneNodeToOnePosition(catchedFish,catchedFishTargetPosition);\n                    var catchedFishesNode = cc.find(\"Canvas/catchedFishesNode\");\n                    catchedFishesNode.addChild(catchedFish);\n                    catchedFish.runAction(action);\n                    \n                    //setup dollorLabel\n                    var newLabel = cc.instantiate(this.dollorLabelPrefab);\n                    newLabel.setPosition(position);\n                    dollorLabelesNode.addChild(newLabel);\n                    var fadeOut = cc.fadeOut(1.0);\n                    var action = cc.sequence(fadeOut,cc.removeSelf());\n                    newLabel.runAction(action);\n                    break;\n                }\n            }\n        } \n    },\n});\n"]}